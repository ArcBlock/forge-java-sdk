buildscript {
  ext.kotlin_version = '1.3.21'
  repositories {
    mavenCentral()
  }
  dependencies {
    classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.21"
    classpath 'com.google.protobuf:protobuf-gradle-plugin:0.8.8'
  }
}

plugins {
  id 'java'
  id 'org.jetbrains.kotlin.jvm' version '1.3.21'

}
apply plugin: 'jacoco'
apply plugin: 'maven-publish'
apply plugin: 'com.google.protobuf'
group 'forge-java-sdk'
version '0.23.0-SNAPSHOT'

sourceCompatibility = 1.8

sourceSets {
  main {
    kotlin { srcDir "src/main/kotlin" }
    java { srcDirs ("src/main/java",
      "build/classes/java/main"
    )
    }
  }
  test {
    kotlin { srcDir "src/test/kotlin" }
    java { srcDir "src/test/java" }
  }
}


compileKotlin {
  kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
  kotlinOptions.jvmTarget = "1.8"
}


protobuf {
  protoc {
    artifact = "com.google.protobuf:protoc:3.2.0"
  }
  plugins {
    grpc {
      artifact = 'io.grpc:protoc-gen-grpc-java:1.4.0'
    }
  }
  generatedFilesBaseDir = "src"

  generateProtoTasks {
    all()*.plugins {
      grpc {
        outputSubDir = "java"
      }
    }
  }
}



repositories {
    mavenCentral()
}

dependencies {
  implementation 'com.google.protobuf:protobuf-java:3.6.1'
  implementation 'org.bitcoinj:bitcoinj-core:0.14.3'
  implementation 'com.madgag.spongycastle:prov:1.58.0.0'
  implementation ('org.web3j:core:4.2.0-android') {
    exclude module: 'jackson-core'
    exclude module: 'jackson-annotations'
    exclude module: 'jackson-databind'
  }
  implementation 'io.grpc:grpc-netty:1.4.0'
  implementation 'io.grpc:grpc-protobuf:1.4.0'
  implementation 'io.grpc:grpc-stub:1.4.0'
  implementation ('com.google.code.gson:gson:2.8.2')
//  implementation rootProject.ext.dependencies["utilcode"]
  implementation ('com.google.crypto.tink:tink-android:1.2.2'){
    exclude module:"protobuf-lite"

  }
  implementation 'org.apache.commons:commons-lang3:3.4'
  implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
  testCompile group: 'junit', name: 'junit', version: '4.12'
}

publishing {
  repositories {
    maven {
      def releaseUrl = "s3://android-docs.arcblock.io.s3.amazonaws.com/release"
      def snapshotUrl = "s3://android-docs.arcblock.io.s3.amazonaws.com/snapshot"
      url releaseUrl

      credentials(AwsCredentials) {
        accessKey project.hasProperty("AWS_S3_ACCESSKEY") ? AWS_S3_ACCESSKEY : System.getenv("AWS_S3_ACCESSKEY")
        secretKey project.hasProperty("AWS_S3_SECRETKEY") ? AWS_S3_SECRETKEY : System.getenv("AWS_S3_SECRETKEY")
      }
    }
  }

  publications {
    mavenJava(MavenPublication) {
      groupId rootProject.group
      artifactId 'core'
      version rootProject.version
      from components.java
    }
  }

}

apply from: rootProject.file('./forgeServer.gradle')



